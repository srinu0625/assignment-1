 # Extracting current and previous values for high and low from data1
                        current_time1 = row1[time_column_name]
                        high1 = float(row1[high_column_name])
                        low1 = float(row1[low_column_name])
                        if (high1 > current_high1) or(low1 < current_low1):
                            previous_high1 = current_high1
                            previous_low1 = current_low1
                            current_high1 = high1
                            current_low1 = low1

                        # Extracting current and previous values for high and low from data2
                        current_time2 = (data2.at[index2 - 1, time_column_name])
                        high2 = float(row1[high_column_name])
                        low2 = float(row1[low_column_name])
                        if (high2 > current_high2) or(low2 < current_low2):
                            previous_high2 = current_high2
                            previous_low2 = current_low2
                            current_high2 = high2
                            current_low2 = low2